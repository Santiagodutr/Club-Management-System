---
import AdminLayout from '../../layouts/AdminLayout.astro'

export const prerender = false
---

<AdminLayout title="Datos de Empresa - Club del Meta" active="datos-empresa">
  <section class="panel">
    <header class="panel__header">
      <div>
        <p class="eyebrow">Administración</p>
        <h1>Datos de Empresa</h1>
        <p class="muted">Gestiona la información de la empresa: NIT, cuentas bancarias, dirección y contactos.</p>
      </div>
      <div class="actions">
        <button id="btnEditar" class="btn primary">Editar</button>
        <button id="btnGuardarCambios" class="btn primary" style="display: none;">Guardar Cambios</button>
        <button id="btnCancelar" class="btn ghost" style="display: none;">Cancelar</button>
      </div>
    </header>

    <div class="grid">
      <!-- Información Tributaria -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Tributaria</p>
            <h2>Información Fiscal</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="nit">
            NIT
            <div class="field-display" id="nitDisplay"></div>
            <input 
              type="text" 
              id="nit" 
              placeholder="900123456-7"
              required
              disabled
              style="display: none;"
            />
          </label>
        </div>
      </section>

      <!-- Cuentas Bancarias -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Bancaria</p>
            <h2>Cuentas de Banco</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="bancolombiaCc">
            Bancolombia - Cuenta Corriente
            <div class="field-display" id="bancolombiaCcDisplay"></div>
            <input 
              type="text" 
              id="bancolombiaCc" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
          <label for="daviviendaCc">
            Davivienda - Cuenta Corriente
            <div class="field-display" id="daviviendaCcDisplay"></div>
            <input 
              type="text" 
              id="daviviendaCc" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
          <label for="daviviendaCa">
            Davivienda - Cuenta de Ahorros
            <div class="field-display" id="daviviendaCaDisplay"></div>
            <input 
              type="text" 
              id="daviviendaCa" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
        </div>
      </section>

      <!-- Ubicación -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Ubicación</p>
            <h2>Dirección</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="direccion">
            Dirección
            <div class="field-display" id="direccionDisplay"></div>
            <textarea 
              id="direccion" 
              rows="2"
              placeholder="Calle 123 # 45-67, Villavicencio, Meta"
              disabled
              style="display: none;"
            ></textarea>
          </label>
        </div>
      </section>

      <!-- Contacto -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Contacto</p>
            <h2>Información del Gerente</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="emailGerente">
            Email del Gerente
            <div class="field-display" id="emailGerenteDisplay"></div>
            <input 
              type="email" 
              id="emailGerente" 
              placeholder="gerente@clubdelmeta.com"
              disabled
              style="display: none;"
            />
          </label>
          <label for="whatsappGerente">
            WhatsApp del Gerente
            <div class="field-display" id="whatsappGerenteDisplay"></div>
            <div id="whatsappGerenteInput" style="display: none; align-items: center; gap: 0.5rem;">
              <span style="color: #6b7280; font-weight: 500; padding: 0.65rem 0.85rem; border: 1px solid #d1d5db; border-radius: 10px 0 0 10px; background: #f9fafb;">+57</span>
              <input 
                type="tel" 
                id="whatsappGerente" 
                placeholder="3001234567"
                style="border-radius: 0 10px 10px 0; flex: 1;"
                maxlength="10"
                pattern="[0-9]{10}"
                disabled
              />
            </div>
          </label>
        </div>
      </section>
    </div>

    <!-- Mensaje de confirmación -->
    <div id="mensajeConfirmacion" class="mensaje-confirmacion hidden">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 6L9 17l-5-5"></path>
      </svg>
      <span>Datos guardados exitosamente</span>
    </div>

    <!-- Mensaje de error -->
    <div id="mensajeError" class="mensaje-error hidden">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
      <span id="mensajeErrorTexto">Error al guardar los datos</span>
    </div>
  </section>
</AdminLayout>

<script>
import '@scripts/datos-empresa.ts'
</script>

<style>
  .panel { padding: 2rem; max-width: 1200px; margin: 0 auto 4rem; }
  .panel__header { display: flex; justify-content: space-between; gap: 1rem; align-items: flex-start; margin-bottom: 1.5rem; }
  .eyebrow { text-transform: uppercase; letter-spacing: 0.08em; font-size: 0.8rem; color: #0a4ba5; margin: 0 0 0.3rem; }
  h1, h2 { margin: 0; color: #0f172a; }
  h2 { font-size: 1.25rem; }
  .muted { color: #4b5563; margin: 0.4rem 0 0; max-width: 640px; }
  .actions { display: flex; gap: 0.5rem; align-items: center; }
  
  .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.2rem; }
  
  .card { 
    background: #ffffff; 
    border: 1px solid #e5e7eb; 
    border-radius: 16px; 
    padding: 1.5rem; 
    box-shadow: 0 10px 30px rgba(15,23,42,0.06);
    transition: border-color 0.2s ease;
  }
  
  .card.changed { border-color: #f59e0b; }
  
  .card__header { margin-bottom: 1.25rem; }
  
  .form-group { display: flex; flex-direction: column; gap: 1rem; }
  
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  
  label { 
    font-size: 0.9rem; 
    color: #4b5563; 
    display: flex; 
    flex-direction: column; 
    gap: 0.4rem;
    font-weight: 500;
  }
  
  input, textarea { 
    border: 1px solid #d1d5db; 
    border-radius: 10px; 
    padding: 0.65rem 0.85rem; 
    font: inherit; 
    background: #ffffff; 
    color: #111827;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }
  
  input:focus, textarea:focus { 
    outline: none; 
    border-color: #2563eb; 
    box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
  }
  
  input.changed, textarea.changed { 
    border-color: #f59e0b; 
    background: #fffbeb;
  }
  
  textarea { 
    resize: vertical; 
    font-family: inherit;
  }
  
  .btn { 
    border: none; 
    border-radius: 10px; 
    padding: 0.65rem 1.25rem; 
    font-weight: 600; 
    cursor: pointer; 
    font: inherit; 
    transition: transform 0.1s ease, box-shadow 0.2s ease; 
    text-decoration: none; 
    display: inline-block; 
  }
  
  .btn.primary { 
    background: linear-gradient(135deg, #0a4ba5, #2563eb); 
    color: #fff; 
    box-shadow: 0 10px 20px rgba(37,99,235,0.2); 
  }
  
  .btn.primary:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 15px 30px rgba(37,99,235,0.3); 
  }
  
  .btn.primary:active { 
    transform: translateY(0); 
  }
  
  .btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
  }
  
  .hidden { display: none !important; }
  
  .field-display {
    padding: 0.65rem 0.85rem;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 10px;
    color: #111827;
    min-height: 42px;
    display: flex;
    align-items: center;
  }
  
  .field-display:empty::before {
    content: 'Sin información';
    color: #9ca3af;
    font-style: italic;
  }
  
  .mensaje-confirmacion, .mensaje-error {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    font-weight: 500;
    animation: slideIn 0.3s ease;
    z-index: 1000;
  }
  
  .mensaje-confirmacion {
    background: #10b981;
    color: white;
  }
  
  .mensaje-error {
    background: #ef4444;
    color: white;
  }
  
  @keyframes slideIn {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  .placeholder {
    padding: 2rem;
    text-align: center;
    color: #9ca3af;
    font-size: 0.95rem;
  }

  @media (max-width: 768px) {
    .grid { grid-template-columns: 1fr; }
    .form-row { grid-template-columns: 1fr; }
    .panel__header { flex-direction: column; }
  }
</style>
