---
import AdminLayout from '../../layouts/AdminLayout.astro'

export const prerender = false
---

<AdminLayout title="Datos de Empresa - Club del Meta" active="datos-empresa">
  <section class="panel">
    <header class="panel__header">
      <div>
        <p class="eyebrow">Administración</p>
        <h1>Datos de Empresa</h1>
        <p class="muted">Gestiona la información de la empresa: NIT, cuentas bancarias, dirección y contactos.</p>
      </div>
      <div class="actions">
        <button id="btnEditar" class="btn primary">Editar</button>
        <button id="btnGuardarCambios" class="btn primary" style="display: none;">Guardar Cambios</button>
        <button id="btnCancelar" class="btn ghost" style="display: none;">Cancelar</button>
      </div>
    </header>

    <div class="grid">
      <!-- Información Tributaria -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Tributaria</p>
            <h2>Información Fiscal</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="nit">
            NIT
            <div class="field-display" id="nitDisplay"></div>
            <input 
              type="text" 
              id="nit" 
              placeholder="900123456-7"
              required
              disabled
              style="display: none;"
            />
          </label>
        </div>
      </section>

      <!-- Cuentas Bancarias -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Bancaria</p>
            <h2>Cuentas de Banco</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="bancolombiaCc">
            Bancolombia - Cuenta Corriente
            <div class="field-display" id="bancolombiaCcDisplay"></div>
            <input 
              type="text" 
              id="bancolombiaCc" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
          <label for="daviviendaCc">
            Davivienda - Cuenta Corriente
            <div class="field-display" id="daviviendaCcDisplay"></div>
            <input 
              type="text" 
              id="daviviendaCc" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
          <label for="daviviendaCa">
            Davivienda - Cuenta de Ahorros
            <div class="field-display" id="daviviendaCaDisplay"></div>
            <input 
              type="text" 
              id="daviviendaCa" 
              placeholder="1234567890"
              disabled
              style="display: none;"
            />
          </label>
        </div>
      </section>

      <!-- Ubicación -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Ubicación</p>
            <h2>Dirección</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="direccion">
            Dirección
            <div class="field-display" id="direccionDisplay"></div>
            <textarea 
              id="direccion" 
              rows="2"
              placeholder="Calle 123 # 45-67, Villavicencio, Meta"
              disabled
              style="display: none;"
            ></textarea>
          </label>
        </div>
      </section>

      <!-- Contacto -->
      <section class="card">
        <div class="card__header">
          <div>
            <p class="eyebrow">Contacto</p>
            <h2>Información del Gerente</h2>
          </div>
        </div>
        <div class="form-group">
          <label for="emailGerente">
            Email del Gerente
            <div class="field-display" id="emailGerenteDisplay"></div>
            <input 
              type="email" 
              id="emailGerente" 
              placeholder="gerente@clubdelmeta.com"
              disabled
              style="display: none;"
            />
          </label>
          <label for="whatsappGerente">
            WhatsApp del Gerente
            <div class="field-display" id="whatsappGerenteDisplay"></div>
            <div id="whatsappGerenteInput" style="display: none; align-items: center; gap: 0.5rem;">
              <span style="color: #6b7280; font-weight: 500; padding: 0.65rem 0.85rem; border: 1px solid #d1d5db; border-radius: 10px 0 0 10px; background: #f9fafb;">+57</span>
              <input 
                type="tel" 
                id="whatsappGerente" 
                placeholder="3001234567"
                style="border-radius: 0 10px 10px 0; flex: 1;"
                maxlength="10"
                pattern="[0-9]{10}"
                disabled
              />
            </div>
          </label>
        </div>
      </section>
    </div>

    <!-- Mensaje de confirmación -->
    <div id="mensajeConfirmacion" class="mensaje-confirmacion hidden">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 6L9 17l-5-5"></path>
      </svg>
      <span>Datos guardados exitosamente</span>
    </div>

    <!-- Mensaje de error -->
    <div id="mensajeError" class="mensaje-error hidden">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
      <span id="mensajeErrorTexto">Error al guardar los datos</span>
    </div>
  </section>
</AdminLayout>

<script>
import '@scripts/datos-empresa.ts'
</script>

<style>
  /* All base styles come from AdminLayout.astro */
  .panel { width: 100%; max-width: 1200px; }
  .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.25rem; }
  .form-group { display: flex; flex-direction: column; gap: 1rem; }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  .card.changed { border-color: #fbbf24 !important; }
  input.changed, textarea.changed { border-color: #fbbf24; }

  @media (max-width: 768px) {
    .grid { grid-template-columns: 1fr; }
    .form-row { grid-template-columns: 1fr; }
    .panel__header { flex-direction: column; }
  }
</style>